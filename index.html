<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>NeuroCore</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; }
        html, body { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            font-family: "Roboto", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; 
        }
        body { 
            display: flex; align-items: center; justify-content: center; padding: 12px; 
            background: radial-gradient(circle at top, #0ea5e9 0, #020617 50%, #000000 100%); 
            color: #e5e7eb; animation: bgShift 14s infinite alternate ease-in-out; min-height: 100vh; 
        }
        .card { 
            width: 100%; max-width: 540px; max-height: 95vh; 
            background: rgba(15, 23, 42, 0.92); border-radius: 20px; padding: 20px 16px; 
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(59, 130, 246, 0.3); 
            backdrop-filter: blur(14px); display: flex; flex-direction: column; overflow-y: auto; gap: 16px; 
        }
        
        .lang-selector { display: flex; justify-content: flex-end; margin-bottom: 12px; }
        .lang-dropdown { background: rgba(30, 64, 175, 0.55); border: 1px solid rgba(129, 140, 248, 0.5); border-radius: 8px; padding: 6px 10px; color: #e5e7eb; font-size: 12px; cursor: pointer; outline: none; }
        .lang-dropdown:hover { background: rgba(30, 64, 175, 0.7); }
        .card-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .avatar { width: 40px; height: 40px; border-radius: 12px; background: conic-gradient(from 140deg, #22c55e, #22d3ee, #6366f1, #ec4899, #22c55e); display: flex; align-items: center; justify-content: center; color: #020617; font-weight: 700; font-size: 18px; text-shadow: 0 0 6px rgba(15, 23, 42, 0.8); animation: pulseGlow 3s infinite ease-in-out; }
        .title-block { flex: 1; }
        .title { font-size: 18px; font-weight: 700; letter-spacing: 0.14em; text-transform: uppercase; color: #e0f2fe; text-shadow: 0 0 8px rgba(56, 189, 248, 0.9), 0 0 16px rgba(59, 130, 246, 0.8); animation: titleGlow 4s infinite ease-in-out; }
        .subtitle { font-size: 12px; color: #9ca3af; }
        .badge { font-size: 11px; padding: 3px 7px; border-radius: 999px; background: rgba(59, 130, 246, 0.15); border: 1px solid rgba(59, 130, 246, 0.6); color: #bfdbfe; text-transform: uppercase; letter-spacing: 0.08em; }
        .buttons-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin: 10px 0 12px; }
        .btn { padding: 11px 12px; border-radius: 12px; border: 0; cursor: pointer; font-size: 14px; display: flex; flex-direction: column; align-items: flex-start; gap: 3px; transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s ease; color: #e5e7eb; letter-spacing: 0.01em; }
        .btn span.label { font-weight: 600; }
        .btn span.desc { font-size: 11px; color: #cbd5f5; }
        .btn.primary { background: linear-gradient(135deg, #2563eb, #7c3aed); box-shadow: 0 10px 25px rgba(37, 99, 235, 0.45); }
        .btn.secondary { background: rgba(30, 64, 175, 0.55); border: 1px solid rgba(129, 140, 248, 0.5); }
        .btn:hover { transform: translateY(-1px); box-shadow: 0 12px 26px rgba(59, 130, 246, 0.45); }
        .btn:active { transform: translateY(0); box-shadow: none; }
        textarea { width: 100%; min-height: 90px; border-radius: 14px; border: 1px solid rgba(75, 85, 99, 0.9); padding: 9px 10px; font-size: 13px; resize: vertical; background: radial-gradient(circle at top left, #0f172a 0, #020617 60%); color: #e5e7eb; outline: none; font-family: "Roboto", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
        textarea::placeholder { color: #6b7280; }
        textarea:focus { border-color: #38bdf8; box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.8); }
        .bottom-row { margin-top: 8px; display: flex; align-items: center; justify-content: space-between; gap: 8px; flex-wrap: wrap; }
        .hint { font-size: 11px; color: #9ca3af; flex: 1 1 60%; }
        .send-btn { padding: 8px 12px; border-radius: 999px; border: 0; font-size: 13px; font-weight: 500; cursor: pointer; background: linear-gradient(135deg, #22c55e, #16a34a); color: #022c22; display: flex; align-items: center; gap: 4px; box-shadow: 0 10px 22px rgba(34, 197, 94, 0.5); flex-shrink: 0; }
        .send-btn:active { transform: translateY(1px); box-shadow: none; }
        .add-group-btn { width: 100%; padding: 10px 14px; border-radius: 999px; border: 0; cursor: pointer; font-size: 14px; font-weight: 600; background: linear-gradient(135deg, #f97316, #ec4899); color: #fefce8; display: flex; align-items: center; justify-content: center; gap: 6px; box-shadow: 0 10px 25px rgba(248, 113, 113, 0.5); text-decoration: none; transition: all 0.2s ease; }
        .add-group-btn:hover { filter: brightness(1.05); transform: translateY(-1px); }
        .add-group-btn:active { transform: translateY(1px); box-shadow: none; }

        .section-divider { height: 1px; background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.6), transparent); margin: 20px 0; }
        .section-title { display: flex; align-items: center; gap: 12px; font-size: 16px; font-weight: 600; color: #e0f2fe; margin-bottom: 16px; }
        .section-icon { width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .games-icon { background: rgba(75, 85, 99, 0.6); border: 1px solid rgba(156, 163, 175, 0.4); position: relative; overflow: hidden; }
        .game-sphere { position: absolute; width: 8px; height: 8px; background: #f8fafc; border-radius: 50%; animation: sphereFloat 6s infinite linear; }
        .sphere-1 { animation-delay: 0s; top: 4px; left: 4px; }
        .sphere-2 { animation-delay: 2s; top: 12px; right: 4px; }
        .sphere-3 { animation-delay: 4s; bottom: 4px; left: 12px; }
        /* ‚úÖ –ù–û–í–´–ô –ò–ö–û–ù –î–õ–Ø –ö–†–ò–ü–¢–´ - —Å—Ñ–µ—Ä—ã —Å–æ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ */
        .crypto-icon { 
            background: rgba(75, 85, 99, 0.6); 
            border: 1px solid rgba(156, 163, 175, 0.4); 
            position: relative; 
            overflow: hidden; 
        }
        .crypto-arrow { 
            position: absolute; width: 6px; height: 6px; 
            background: #10b981; 
            clip-path: polygon(20% 0%, 100% 50%, 20% 100%); 
            animation: arrowFloat 4s infinite ease-in-out; 
        }
        .crypto-arrow:nth-child(1) { animation-delay: 0s; top: 4px; left: 8px; }
        .crypto-arrow:nth-child(2) { animation-delay: 1.3s; top: 12px; right: 4px; background: #f59e0b; transform: scaleX(-1); }
        .crypto-arrow:nth-child(3) { animation-delay: 2.6s; bottom: 4px; left: 12px; background: #ef4444; }
        @keyframes arrowFloat { 
            0%, 100% { transform: translateY(0px) rotate(0deg) scale(1); opacity: 0.7; } 
            50% { transform: translateY(-6px) rotate(180deg) scale(1.2); opacity: 1; } 
        }
        .coming-soon { font-size: 13px; color: #9ca3af; font-style: italic; }
        
        .crypto-section { background: rgba(17, 24, 39, 0.5); border-radius: 16px; padding: 16px; border: 1px solid rgba(59, 130, 246, 0.3); }
        .crypto-title { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .crypto-price { font-size: 18px; font-weight: 700; background: linear-gradient(135deg, #10b981, #059669); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .chart-container { 
            height: 120px; position: relative; margin-bottom: 12px; 
            background: rgba(15, 23, 42, 0.8); border-radius: 12px; overflow: hidden; 
        }
        #cryptoChart { 
            width: 100% !important; height: 100% !important; 
            background: rgba(17, 24, 39, 0.3); 
        }
        .timeframes { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; }
        .timeframe-btn { padding: 6px 4px; border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.4); background: rgba(15, 23, 42, 0.8); color: #e5e7eb; font-size: 11px; cursor: pointer; transition: all 0.2s ease; }
        .timeframe-btn.active, .timeframe-btn:hover { background: linear-gradient(135deg, #2563eb, #7c3aed); border-color: #60a5fa; color: white; transform: translateY(-1px); }
        .crypto-coins { display: flex; gap: 8px; margin-top: 8px; }
        .coin-btn { width: 36px; height: 36px; border-radius: 10px; border: 2px solid transparent; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s ease; }
        .coin-btn.active { border-color: #10b981; box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.3); transform: scale(1.05); }
        .ton { background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; }
        .btc { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
        .not { background: linear-gradient(135deg, #06b6d4, #0891b2); color: white; }

        .meta-block { margin-top: auto; padding-top: 16px; border-top: 1px solid rgba(55, 65, 81, 0.8); font-size: 11px; color: #9ca3af; display: flex; flex-direction: column; gap: 4px; }
        .meta-title { font-size: 11px; letter-spacing: 0.16em; text-transform: uppercase; color: #a5b4fc; text-shadow: 0 0 8px rgba(129, 140, 248, 0.6); }
        .meta-links { display: flex; justify-content: space-between; gap: 8px; flex-wrap: wrap; }
        .meta-link { color: #38bdf8; text-decoration: none; font-size: 11px; cursor: pointer; }
        .meta-link:hover { text-decoration: underline; }
        @media (max-width: 480px) { .card { padding: 14px 10px 12px; } .title { font-size: 16px; } textarea { min-height: 80px; } }
        @keyframes pulseGlow { 0%, 100% { box-shadow: 0 0 0 rgba(56, 189, 248, 0); } 50% { box-shadow: 0 0 18px rgba(56, 189, 248, 0.9); } }
        @keyframes titleGlow { 0%, 100% { text-shadow: 0 0 4px rgba(56, 189, 248, 0.5), 0 0 8px rgba(59, 130, 246, 0.4); } 50% { text-shadow: 0 0 10px rgba(56, 189, 248, 1), 0 0 22px rgba(59, 130, 246, 0.9); } }
        @keyframes bgShift { 0% { background: radial-gradient(circle at top, #0ea5e9 0, #020617 50%, #000000 100%); } 50% { background: radial-gradient(circle at top, #6366f1 0, #020617 55%, #000000 100%); } 100% { background: radial-gradient(circle at top, #ec4899 0, #020617 50%, #000000 100%); } }
        @keyframes sphereFloat { 0% { transform: translateY(0px) rotate(0deg); opacity: 0.7; } 50% { transform: translateY(-8px) rotate(180deg); opacity: 1; } 100% { transform: translateY(0px) rotate(360deg); opacity: 0.7; } }
    </style>
</head>
<body>
    <div class="card">
        <div class="lang-selector">
            <select class="lang-dropdown" id="langSelect" onchange="changeLanguage(this.value)">
                <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                <option value="en">üá¨üáß English</option>
                <option value="tt">üáπüáπ –¢–∞—Ç–∞—Ä—Å–∫–∏–π</option>
            </select>
        </div>

        <div class="card-header">
            <div class="avatar">NC</div>
            <div class="title-block">
                <div class="title">NEUROCORE</div>
                <div class="subtitle" id="subtitle">–£—á—ë–±–∞ ¬∑ —Ç–µ–∫—Å—Ç—ã ¬∑ –∏–¥–µ–∏ ¬∑ 18+</div>
            </div>
            <div class="badge">beta</div>
        </div>

        <div class="buttons-grid">
            <button class="btn primary" onclick="setMode('question')">
                <span class="label" id="btn1-label">–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å</span>
                <span class="desc" id="btn1-desc">–°–ø—Ä–æ—Å–∏ —á—Ç–æ —É–≥–æ–¥–Ω–æ</span>
            </button>
            <button class="btn secondary" onclick="setMode('explain')">
                <span class="label" id="btn2-label">–û–±—ä—è—Å–Ω–∏—Ç—å —Ç–µ–º—É</span>
                <span class="desc" id="btn2-desc">–¢–µ–º—ã, –∑–∞–¥–∞—á–∏, —Ç–µ–æ—Ä–∏—é</span>
            </button>
            <button class="btn secondary" onclick="setMode('fix')">
                <span class="label" id="btn3-label">–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç</span>
                <span class="desc" id="btn3-desc">–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è –∏ —Å—Ç–∏–ª—å</span>
            </button>
            <button class="btn secondary" onclick="setMode('ideas')">
                <span class="label" id="btn4-label">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏</span>
                <span class="desc" id="btn4-desc">–ü—Ä–æ–µ–∫—Ç—ã, —Å—é–∂–µ—Ç—ã, –ø–æ–¥–∞—Ä–∫–∏</span>
            </button>
        </div>

        <textarea id="prompt" placeholder="–ù–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç –¥–ª—è NeuroCore‚Ä¶"></textarea>
        <div class="bottom-row">
            <div class="hint" id="hint">–≠—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ Mini App. –¢–µ–∫—Å—Ç —É–ª–µ—Ç–∏—Ç –±–æ—Ç—É —á–µ—Ä–µ–∑ WebApp.</div>
            <button class="send-btn" id="sendBtn" onclick="sendToBot()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>

        <div class="add-group">
            <button class="add-group-btn" type="button" id="addGroupBtn" onclick="inviteToGroup()">
                üë• <span id="addBtnText">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å NeuroCore –≤ –≥—Ä—É–ø–ø—É</span>
            </button>
        </div>

        <div class="section-divider"></div>
        <div class="section-title">
            <div class="section-icon games-icon">
                <div class="game-sphere sphere-1"></div>
                <div class="game-sphere sphere-2"></div>
                <div class="game-sphere sphere-3"></div>
            </div>
            <span id="gamesTitle">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</span>
        </div>
        <div style="text-align: center; color: #6b7280; font-size: 14px;">
            <span id="comingSoon" class="coming-soon">–°–∫–æ—Ä–æ...</span>
        </div>

        <div class="section-divider"></div>
        <!-- ‚úÖ –ò–ó–ú–ï–ù–Å–ù –ö–†–ò–ü–¢–û –ò–ö–û–ù - —Ç–µ–ø–µ—Ä—å —Å—Ñ–µ—Ä—ã —Å–æ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ -->
        <div class="section-title">
            <div class="section-icon crypto-icon">
                <div class="crypto-arrow"></div>
                <div class="crypto-arrow"></div>
                <div class="crypto-arrow"></div>
            </div>
            <span id="cryptoTitle">–ö—Ä–∏–ø—Ç–∞</span>
        </div>
        <div class="crypto-section">
            <div class="crypto-title">
                <span class="crypto-price" id="cryptoPrice">$1.65</span>
                <span id="cryptoChange" style="font-size: 12px; color: #10b981;">+3.2%</span>
            </div>
            <div class="crypto-coins">
                <button class="coin-btn ton active" onclick="setCryptoCoin(event, 'ton')">TON</button>
                <button class="coin-btn btc" onclick="setCryptoCoin(event, 'btc')">BTC</button>
                <button class="coin-btn not" onclick="setCryptoCoin(event, 'not')">NOT</button>
            </div>
            <div class="chart-container">
                <canvas id="cryptoChart"></canvas>
            </div>
            <div class="timeframes">
                <button class="timeframe-btn" data-time="1h" onclick="setTimeframe(event, '1h')">1—á</button>
                <button class="timeframe-btn" data-time="6h" onclick="setTimeframe(event, '6h')">6—á</button>
                <button class="timeframe-btn active" data-time="1d" onclick="setTimeframe(event, '1d')">1–¥</button>
                <button class="timeframe-btn" data-time="7d" onclick="setTimeframe(event, '7d')">7–¥</button>
            </div>
        </div>

        <div class="meta-block">
            <div class="meta-title">SYSTEM</div>
            <div class="meta-links">
                <a class="meta-link" href="https://oppennnbox.github.io/neurocore-miniapp/privacy.html" target="_blank" id="privacyLink">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                <a class="meta-link" href="https://t.me/genuis_neo_bot" target="_blank" id="devLink">–°–≤—è–∑—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º</a>
            </div>
        </div>
    </div>

    <script>
        // –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentMode = 'question';
        let currentLang = 'ru';
        let currentCoin = 'ton';
        let currentTimeframe = '1d';
        let cryptoChart = null;
        const tg = window.Telegram?.WebApp || {};

        // CoinGecko IDs –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        const COINGECKO_IDS = {
            ton: 'the-open-network',
            btc: 'bitcoin',
            not: 'notcoin'
        };

        // –¶–≤–µ—Ç–∞ –º–æ–Ω–µ—Ç
        const coinColors = {
            ton: '#8b5cf6',
            btc: '#f59e0b', 
            not: '#06b6d4'
        };

        const translations = {
            ru: {
                subtitle: "–£—á—ë–±–∞ ¬∑ —Ç–µ–∫—Å—Ç—ã ¬∑ –∏–¥–µ–∏ ¬∑ 18+",
                btn1_label: "–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å", btn1_desc: "–°–ø—Ä–æ—Å–∏ —á—Ç–æ —É–≥–æ–¥–Ω–æ",
                btn2_label: "–û–±—ä—è—Å–Ω–∏—Ç—å —Ç–µ–º—É", btn2_desc: "–¢–µ–º—ã, –∑–∞–¥–∞—á–∏, —Ç–µ–æ—Ä–∏—é",
                btn3_label: "–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç", btn3_desc: "–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è –∏ —Å—Ç–∏–ª—å",
                btn4_label: "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏", btn4_desc: "–ü—Ä–æ–µ–∫—Ç—ã, —Å—é–∂–µ—Ç—ã, –ø–æ–¥–∞—Ä–∫–∏",
                placeholder: "–ù–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç –¥–ª—è NeuroCore‚Ä¶",
                hint: "–≠—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ Mini App. –¢–µ–∫—Å—Ç —É–ª–µ—Ç–∏—Ç –±–æ—Ç—É —á–µ—Ä–µ–∑ WebApp.",
                send: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
                addBtnText: "–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å NeuroCore –≤ –≥—Ä—É–ø–ø—É",
                gamesTitle: "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
                comingSoon: "–°–∫–æ—Ä–æ...",
                cryptoTitle: "–ö—Ä–∏–ø—Ç–∞",
                privacy: "–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏",
                dev: "–°–≤—è–∑—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º"
            },
            en: {
                subtitle: "Study ¬∑ texts ¬∑ ideas ¬∑ 18+",
                btn1_label: "Ask a question", btn1_desc: "Ask anything",
                btn2_label: "Explain topic", btn2_desc: "Subjects, problems, theory",
                btn3_label: "Fix text", btn3_desc: "Spelling & style",
                btn4_label: "Generate ideas", btn4_desc: "Projects, plots, gifts",
                placeholder: "Write something for NeuroCore‚Ä¶",
                hint: "This interface works as a Mini App. The text will be sent to the bot via WebApp.",
                send: "Send",
                addBtnText: "Invite NeuroCore to group",
                gamesTitle: "Games",
                comingSoon: "Coming soon...",
                cryptoTitle: "Crypto",
                privacy: "Privacy Policy",
                dev: "Contact developer"
            },
            tt: {
                subtitle: "–£–∫—É ¬∑ —Ç–µ–∫—Å—Ç–ª–∞—Ä ¬∑ –∏–¥–µ—è–ª–∞—Ä ¬∑ 18+",
                btn1_label: "–°–æ—Ä–∞—É –±–∏—Ä–µ—Ä–≥”ô", btn1_desc: "–¢–µ–ª”ô—Å”ô–Ω–≥”ô —Å–æ—Ä–∞",
                btn2_label: "–¢–µ–º–∞ —Ñ”ô–Ω–Ω–∏", btn2_desc: "–¢–µ–º–∞–ª–∞—Ä, –º”ô—Å—å”ô–ª”ô–ª”ô—Ä, —Ç–µ–æ—Ä–∏—è",
                btn3_label: "–¢–µ–∫—Å—Ç–Ω—ã —Ç”©–∑”ô—Ç", btn3_desc: "–Ø–∑–º–∞–ª–∞—Ä “ª”ô–º —Å—Ç–∏–ª—å",
                btn4_label: "–ò–¥–µ—è–ª–∞—Ä —è—Å”ô", btn4_desc: "–ü—Ä–æ–µ–∫—Ç–ª–∞—Ä, —Å—é–∂–µ—Ç–ª–∞—Ä, —Ç–∞—Ä—Ç—É–ª–∞—Ä",
                placeholder: "NeuroCore ”©—á–µ–Ω —Ç–µ–∫—Å—Ç —è–∑‚Ä¶",
                hint: "–ë—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Mini App —Å—ã–Ω—ã—Ñ—ã–Ω–¥–∞ —ç—à–ª–∏. –¢–µ–∫—Å—Ç –±–æ—Ç–∫–∞ WebApp –∞—à–∞ –æ—á—ã–ø –±–∞—Ä—ã—Ä–≥–∞ —Ç–∏–µ—à.",
                send: "“ñ–∏–±”ô—Ä“Ø",
                addBtnText: "NeuroCore-–Ω—ã –≥—Ä—É–ø–ø–∫–∞ —á–∞–∫—ã—Ä—ã—Ä–≥–∞",
                gamesTitle: "–í–∞–∫—ã—Ç “Ø—Ç–∫”ô—Ä“Ø",
                comingSoon: "–¢–∏–∑–¥”ô–Ω...",
                cryptoTitle: "–ö—Ä–∏–ø—Ç–∞",
                privacy: "–§”ô—Ä–µ—à—Ç”ô–ª–µ–∫ —Å–∏–∏—Å–∞—Ç–µ",
                dev: "–î–µ–≤–µ–ª–æ–ø–µ—Ä –±–µ–ª”ô–Ω –±”ô–π–ª”ô–Ω–µ—à"
            }
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
        if (tg.initDataUnsafe) tg.expand();
        if (tg.MainButton) {
            tg.MainButton.setText('–û—Ç–ø—Ä–∞–≤–∏—Ç—å').show().onClick(sendToBot);
        }

        // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø - –¢–û–ß–ù–´–ï –¶–ï–ù–´ –ë–ï–ó –û–ö–†–£–ì–õ–ï–ù–ò–Ø
        async function fetchRealPrice() {
            try {
                const coinId = COINGECKO_IDS[currentCoin];
                const response = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${coinId}&vs_currencies=usd&include_24hr_change=true&precision=full`);
                const data = await response.json();
                
                const price = data[coinId].usd;
                const change = data[coinId].usd_24h_change;
                
                // ‚úÖ –¢–û–ß–ù–ê–Ø –¶–ï–ù–ê –ë–ï–ó –û–ö–†–£–ì–õ–ï–ù–ò–Ø - –ø–æ–ª–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å!
                document.getElementById('cryptoPrice').textContent = '$' + price.toLocaleString(undefined, { 
                    minimumFractionDigits: 0, 
                    maximumFractionDigits: 8 
                });
                
                const changeEl = document.getElementById('cryptoChange');
                changeEl.textContent = (change > 0 ? '+' : '') + change.toFixed(2) + '%';
                changeEl.style.color = change > 0 ? '#10b981' : '#ef4444';
                
                return { price, change };
            } catch (error) {
                console.log('API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—é —Ñ–µ–π–∫');
                updatePrice();
                return null;
            }
        }

        // ‚úÖ –ì–†–ê–§–ò–ö –° –û–ö–†–£–ì–õ–ï–ù–ò–ï–ú –ù–ê –®–ö–ê–õ–ï (–∫–∞–∫ –ø—Ä–æ—Å–∏–ª)
        async function createRealChart() {
            const canvas = document.getElementById('cryptoChart');
            const ctx = canvas.getContext('2d');
            
            if (cryptoChart) {
                cryptoChart.destroy();
                cryptoChart = null;
            }

            try {
                const coinId = COINGECKO_IDS[currentCoin];
                let days = 1;
                if (currentTimeframe === '1h') days = 1;
                else if (currentTimeframe === '6h') days = 2;
                else if (currentTimeframe === '1d') days = 7;
                else days = 14;

                const response = await fetch(`https://api.coingecko.com/api/v3/coins/${coinId}/market_chart?vs_currency=usd&days=${days}&interval=daily`);
                const data = await response.json();
                
                const prices = data.prices.map(p => p[1]);
                const labels = prices.map((_, i) => '');

                cryptoChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: prices,
                            borderColor: coinColors[currentCoin],
                            backgroundColor: coinColors[currentCoin] + '20',
                            borderWidth: 2.5,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { 
                                grid: { display: false },
                                ticks: { display: false }
                            },
                            y: {
                                grid: { color: 'rgba(148, 163, 184, 0.15)' },
                                ticks: {
                                    color: '#94a3b8',
                                    // ‚úÖ –û–ö–†–£–ì–õ–ï–ù–ò–ï –¢–û–õ–¨–ö–û –ù–ê –®–ö–ê–õ–ï –ì–†–ê–§–ò–ö–ê
                                    callback: function(value) {
                                        if (value >= 1000) return '$' + (value / 1000).toFixed(1) + 'k';
                                        return '$' + value.toFixed(1);
                                    }
                                }
                            }
                        },
                        animation: { duration: 800 }
                    }
                });
            } catch (error) {
                createChart();
            }
        }

        // Fallback —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        function updatePrice() {
            const cryptoPrices = {
                ton: { price: 1.795, change: 2.8, color: '#8b5cf6' },
                btc: { price: 95432.15, change: 1.9, color: '#f59e0b' },
                not: { price: 0.01234, change: 7.5, color: '#06b6d4' }
            };
            const coin = cryptoPrices[currentCoin];
            document.getElementById('cryptoPrice').textContent = '$' + coin.price.toFixed(5);
            const changeEl = document.getElementById('cryptoChange');
            changeEl.textContent = (coin.change > 0 ? '+' : '') + coin.change + '%';
            changeEl.style.color = coin.change > 0 ? '#10b981' : '#ef4444';
        }

        function createChart() {
            const canvas = document.getElementById('cryptoChart');
            const ctx = canvas.getContext('2d');
            
            if (cryptoChart) {
                cryptoChart.destroy();
                cryptoChart = null;
            }

            const basePrices = { ton: 1.795, btc: 95432.15, not: 0.01234 };
            const data = [];
            const basePrice = basePrices[currentCoin];
            for (let i = 0; i < 24; i++) {
                const variation = basePrice * (0.94 + Math.sin(i * 0.3) * 0.08 + (Math.random() - 0.5) * 0.04);
                data.push(variation);
            }

            cryptoChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array(24).fill(''),
                    datasets: [{
                        data: data,
                        borderColor: coinColors[currentCoin],
                        backgroundColor: coinColors[currentCoin] + '20',
                        borderWidth: 2.5,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false }, ticks: { display: false } },
                        y: {
                            grid: { color: 'rgba(148, 163, 184, 0.15)' },
                            ticks: {
                                color: '#94a3b8',
                                callback: function(value) {
                                    if (value >= 1000) return '$' + (value / 1000).toFixed(1) + 'k';
                                    return '$' + value.toFixed(1);
                                }
                            }
                        }
                    },
                    animation: { duration: 800 }
                }
            });
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô
        function changeLanguage(lang) {
            currentLang = lang;
            const t = translations[lang] || translations.ru;
            
            ['subtitle','btn1-label','btn1-desc','btn2-label','btn2-desc','btn3-label','btn3-desc','btn4-label','btn4-desc','prompt','hint','sendBtn','addBtnText','gamesTitle','comingSoon','cryptoTitle','privacyLink','devLink'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.textContent = t[id.replace(/([A-Z])/g, '-$1').toLowerCase()] || t[id] || el.textContent;
            });
            
            if (tg.MainButton) tg.MainButton.setText(t.send || '–û—Ç–ø—Ä–∞–≤–∏—Ç—å');
            localStorage.setItem('neurocore_lang', lang);
        }

        function setMode(mode) {
            currentMode = mode;
            const prompt = document.getElementById('prompt');
            const t = translations[currentLang] || translations.ru;
            const prefixes = { question: '', explain: '–û–±—ä—è—Å–Ω–∏: ', fix: '–ò—Å–ø—Ä–∞–≤—å: ', ideas: '–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∏–¥–µ–∏: ' };
            prompt.placeholder = (prefixes[mode] || '') + t.placeholder;
            prompt.focus();
        }

        function sendToBot() {
            const text = document.getElementById('prompt').value.trim();
            if (!text) return;
            
            const t = translations[currentLang] || translations.ru;
            const modes = { question: t['btn1_label'], explain: t['btn2_label'], fix: t['btn3_label'], ideas: t['btn4_label'] };
            tg.sendData(JSON.stringify({ message: `${modes[currentMode] || '–í–æ–ø—Ä–æ—Å'}: ${text}` }));
            document.getElementById('prompt').value = '';
        }

        function inviteToGroup() {
            const btn = document.getElementById('addGroupBtn');
            btn.style.transform = 'scale(0.97)';
            setTimeout(() => btn.style.transform = '', 150);
            tg.openTelegramLink?.('https://t.me/genuis_neo_bot?startgroup=true');
        }

        function setCryptoCoin(e, coin) {
            currentCoin = coin;
            document.querySelectorAll('.coin-btn').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            fetchRealPrice().then(() => createRealChart());
        }

        function setTimeframe(e, timeframe) {
            currentTimeframe = timeframe;
            document.querySelectorAll('.timeframe-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.time === timeframe) btn.classList.add('active');
            });
            createRealChart();
        }

        document.addEventListener('DOMContentLoaded', () => {
            const savedLang = localStorage.getItem('neurocore_lang') || 'ru';
            document.getElementById('langSelect').value = savedLang;
            changeLanguage(savedLang);
            setMode('question');
            
            setTimeout(() => {
                fetchRealPrice().then(() => createRealChart());
                setInterval(() => {
                    fetchRealPrice().then(() => createRealChart());
                }, 120000);
            }, 300);
        });

        document.addEventListener('keydown', e => {
            if (e.ctrlKey && e.key === 'Enter') sendToBot();
        });
    </script>
</body>
</html>

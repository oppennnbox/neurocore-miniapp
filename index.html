<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>NeuroCore</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; }
        html, body { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            font-family: "Roboto", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; 
        }
        body { 
            display: flex; align-items: center; justify-content: center; padding: 12px;
            background: radial-gradient(circle at top, #0ea5e9 0, #020617 50%, #000000 100%);
            color: #e5e7eb; animation: bgShift 14s infinite alternate ease-in-out; min-height: 100vh; 
        }
        .card { 
            width: 100%; max-width: 540px; max-height: 95vh;
            background: rgba(15, 23, 42, 0.92); border-radius: 20px; padding: 20px 16px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(59, 130, 246, 0.3);
            backdrop-filter: blur(14px); display: flex; flex-direction: column; overflow-y: auto; gap: 16px; 
        }
        
        .lang-selector { display: flex; justify-content: flex-end; margin-bottom: 12px; }
        .lang-dropdown { background: rgba(30, 64, 175, 0.55); border: 1px solid rgba(129, 140, 248, 0.5); border-radius: 8px; padding: 6px 10px; color: #e5e7eb; font-size: 12px; cursor: pointer; outline: none; }
        .lang-dropdown:hover { background: rgba(30, 64, 175, 0.7); }
        
        .card-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .avatar { width: 40px; height: 40px; border-radius: 12px; background: conic-gradient(from 140deg, #22c55e, #22d3ee, #6366f1, #ec4899, #22c55e); display: flex; align-items: center; justify-content: center; color: #020617; font-weight: 700; font-size: 18px; text-shadow: 0 0 6px rgba(15, 23, 42, 0.8); animation: pulseGlow 3s infinite ease-in-out; }
        .title-block { flex: 1; }
        .title { font-size: 18px; font-weight: 700; letter-spacing: 0.14em; text-transform: uppercase; color: #e0f2fe; text-shadow: 0 0 8px rgba(56, 189, 248, 0.9), 0 0 16px rgba(59, 130, 246, 0.8); animation: titleGlow 4s infinite ease-in-out; }
        .subtitle { font-size: 12px; color: #9ca3af; }
        .badge { font-size: 11px; padding: 3px 7px; border-radius: 999px; background: rgba(59, 130, 246, 0.15); border: 1px solid rgba(59, 130, 246, 0.6); color: #bfdbfe; text-transform: uppercase; letter-spacing: 0.08em; }
        
        .buttons-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin: 10px 0 12px; }
        .btn { padding: 11px 12px; border-radius: 12px; border: 0; cursor: pointer; font-size: 14px; display: flex; flex-direction: column; align-items: flex-start; gap: 3px; transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s ease; color: #e5e7eb; letter-spacing: 0.01em; }
        .btn span.label { font-weight: 600; }
        .btn span.desc { font-size: 11px; color: #cbd5f5; }
        .btn.primary { background: linear-gradient(135deg, #2563eb, #7c3aed); box-shadow: 0 10px 25px rgba(37, 99, 235, 0.45); }
        .btn.secondary { background: rgba(30, 64, 175, 0.55); border: 1px solid rgba(129, 140, 248, 0.5); }
        .btn:hover { transform: translateY(-1px); box-shadow: 0 12px 26px rgba(59, 130, 246, 0.45); }
        .btn:active { transform: translateY(0); box-shadow: none; }
        
        textarea { width: 100%; min-height: 90px; border-radius: 14px; border: 1px solid rgba(75, 85, 99, 0.9); padding: 9px 10px; font-size: 13px; resize: vertical; background: radial-gradient(circle at top left, #0f172a 0, #020617 60%); color: #e5e7eb; outline: none; font-family: "Roboto", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
        textarea::placeholder { color: #6b7280; }
        textarea:focus { border-color: #38bdf8; box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.8); }
        
        .bottom-row { margin-top: 8px; display: flex; align-items: center; justify-content: space-between; gap: 8px; flex-wrap: wrap; }
        .hint { font-size: 11px; color: #9ca3af; flex: 1 1 60%; }
        .send-btn { padding: 8px 12px; border-radius: 999px; border: 0; font-size: 13px; font-weight: 500; cursor: pointer; background: linear-gradient(135deg, #22c55e, #16a34a); color: #022c22; display: flex; align-items: center; gap: 4px; box-shadow: 0 10px 22px rgba(34, 197, 94, 0.5); flex-shrink: 0; }
        .send-btn:active { transform: translateY(1px); box-shadow: none; }
        
        .add-group-btn { width: 100%; padding: 10px 14px; border-radius: 999px; border: 0; cursor: pointer; font-size: 14px; font-weight: 600; background: linear-gradient(135deg, #f97316, #ec4899); color: #fefce8; display: flex; align-items: center; justify-content: center; gap: 6px; box-shadow: 0 10px 25px rgba(248, 113, 113, 0.5); text-decoration: none; transition: all 0.2s ease; }
        .add-group-btn:hover { filter: brightness(1.05); transform: translateY(-1px); }
        .add-group-btn:active { transform: translateY(1px); box-shadow: none; }
        
        .section-divider { height: 1px; background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.6), transparent); margin: 20px 0; }
        .section-title { display: flex; align-items: center; gap: 12px; font-size: 16px; font-weight: 600; color: #e0f2fe; margin-bottom: 16px; }
        .section-icon { width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .games-icon { background: rgba(75, 85, 99, 0.6); border: 1px solid rgba(156, 163, 175, 0.4); position: relative; overflow: hidden; }
        .game-sphere { position: absolute; width: 8px; height: 8px; background: #f8fafc; border-radius: 50%; animation: sphereFloat 6s infinite linear; }
        .sphere-1 { animation-delay: 0s; top: 4px; left: 4px; }
        .sphere-2 { animation-delay: 2s; top: 12px; right: 4px; }
        .sphere-3 { animation-delay: 4s; bottom: 4px; left: 12px; }
        
        /* ‚úÖ –ö–†–ò–ü–¢–û –ò–ö–û–ù–ê */
        .crypto-icon { 
            background: rgba(75, 85, 99, 0.6); 
            border: 1px solid rgba(156, 163, 175, 0.4); 
            position: relative; overflow: hidden; 
        }
        .crypto-arrow { 
            position: absolute; width: 6px; height: 6px; 
            background: #10b981; 
            clip-path: polygon(20% 0%, 100% 50%, 20% 100%); 
            animation: arrowFloat 4s infinite ease-in-out; 
        }
        .crypto-arrow:nth-child(1) { animation-delay: 0s; top: 4px; left: 8px; }
        .crypto-arrow:nth-child(2) { animation-delay: 1.3s; top: 12px; right: 4px; background: #f59e0b; transform: scaleX(-1); }
        .crypto-arrow:nth-child(3) { animation-delay: 2.6s; bottom: 4px; left: 12px; background: #ef4444; }
        @keyframes arrowFloat { 
            0%, 100% { transform: translateY(0px) rotate(0deg) scale(1); opacity: 0.7; }
            50% { transform: translateY(-6px) rotate(180deg) scale(1.2); opacity: 1; }
        }
        
        /* ‚úÖ –ù–û–í–´–ô –ò–ö–û–ù –î–õ–Ø –ö–û–ù–í–ï–†–¢–ï–†–ê –ö–†–ò–ü–¢–ê‚Üí–†–£–ë–õ–ò */
        .converter-icon {
            background: rgba(75, 85, 99, 0.6); 
            border: 1px solid rgba(156, 163, 175, 0.4); 
            position: relative; overflow: hidden; 
        }
        .rub-sign { 
            position: absolute; font-size: 16px; font-weight: 700; color: #f59e0b; 
            animation: rubPulse 2s infinite ease-in-out; 
        }
        .rub-sign:nth-child(1) { top: 6px; left: 8px; animation-delay: 0s; }
        .rub-sign:nth-child(2) { top: 10px; right: 6px; font-size: 14px; animation-delay: 0.7s; }
        @keyframes rubPulse {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.8; }
            50% { transform: scale(1.1) rotate(10deg); opacity: 1; }
        }
        
        /* ‚úÖ –ò–ö–û–ù –î–õ–Ø –í–ê–õ–Æ–¢ */
        .currency-icon {
            background: rgba(75, 85, 99, 0.6); 
            border: 1px solid rgba(156, 163, 175, 0.4); 
            position: relative; overflow: hidden; 
        }
        .currency-dollar { 
            position: absolute; font-size: 14px; font-weight: 700; color: #10b981; 
            animation: currencyFloat 3s infinite ease-in-out; 
        }
        .currency-euro { background: #3b82f6; }
        .currency-dollar:nth-child(1) { top: 4px; left: 6px; }
        .currency-dollar:nth-child(2) { bottom: 4px; right: 6px; font-size: 12px; animation-delay: 1s; }
        @keyframes currencyFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-4px); }
        }
        
        .coming-soon { font-size: 13px; color: #9ca3af; font-style: italic; }
        
        .crypto-section { background: rgba(17, 24, 39, 0.5); border-radius: 16px; padding: 16px; border: 1px solid rgba(59, 130, 246, 0.3); }
        .crypto-title { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .crypto-price { font-size: 18px; font-weight: 700; background: linear-gradient(135deg, #10b981, #059669); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .chart-container { height: 120px; position: relative; margin-bottom: 12px; background: rgba(15, 23, 42, 0.8); border-radius: 12px; overflow: hidden; }
        #cryptoChart { width: 100% !important; height: 100% !important; background: rgba(17, 24, 39, 0.3); }
        .timeframes { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; }
        .timeframe-btn { padding: 6px 4px; border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.4); background: rgba(15, 23, 42, 0.8); color: #e5e7eb; font-size: 11px; cursor: pointer; transition: all 0.2s ease; }
        .timeframe-btn.active, .timeframe-btn:hover { background: linear-gradient(135deg, #2563eb, #7c3aed); border-color: #60a5fa; color: white; transform: translateY(-1px); }
        .crypto-coins { display: flex; gap: 8px; margin-top: 8px; }
        .coin-btn { width: 36px; height: 36px; border-radius: 10px; border: 2px solid transparent; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s ease; }
        .coin-btn.active { border-color: #10b981; box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.3); transform: scale(1.05); }
        .ton { background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; }
        .btc { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
        .not { background: linear-gradient(135deg, #06b6d4, #0891b2); color: white; }

        /* ‚úÖ –°–¢–ò–õ–ò –î–õ–Ø –ö–û–ù–í–ï–†–¢–ï–†–ê –ö–†–ò–ü–¢–ê‚Üí–†–£–ë–õ–ò */
        .crypto-converter { background: rgba(16, 185, 129, 0.15); border: 1px solid rgba(16, 185, 129, 0.4); border-radius: 12px; padding: 14px; margin-top: 12px; }
        .converter-row { display: flex; gap: 8px; align-items: center; margin-bottom: 8px; }
        .converter-input { flex: 1; padding: 8px 10px; border: 1px solid rgba(75, 85, 99, 0.6); border-radius: 8px; background: rgba(15, 23, 42, 0.8); color: #e5e7eb; font-size: 14px; }
        .converter-select { padding: 8px 10px; border: 1px solid rgba(75, 85, 99, 0.6); border-radius: 8px; background: rgba(15, 23, 42, 0.8); color: #e5e7eb; font-size: 14px; }
        .converter-result { font-size: 16px; font-weight: 600; color: #f59e0b; text-align: center; padding: 10px; background: rgba(249, 158, 11, 0.1); border-radius: 8px; }

        /* ‚úÖ –°–¢–ò–õ–ò –î–õ–Ø –í–ê–õ–Æ–¢–ù–û–ô –°–ï–ö–¶–ò–ò */
        .currency-section { background: rgba(34, 197, 94, 0.15); border: 1px solid rgba(34, 197, 94, 0.4); border-radius: 16px; padding: 16px; }
        .currency-converter-row { display: flex; gap: 8px; align-items: center; margin-bottom: 12px; }
        .currency-chart-container { height: 100px; position: relative; margin-bottom: 12px; background: rgba(15, 23, 42, 0.8); border-radius: 12px; overflow: hidden; }
        .currency-coins { display: flex; gap: 6px; margin-bottom: 8px; }
        .currency-btn { width: 44px; height: 36px; border-radius: 8px; border: 2px solid transparent; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s ease; background: rgba(15, 23, 42, 0.8); color: #e5e7eb; }
        .currency-btn.active { border-color: #22c55e; background: rgba(34, 197, 94, 0.2); transform: scale(1.05); }
        .currency-result { font-size: 16px; font-weight: 600; color: #22c55e; text-align: center; padding: 10px; background: rgba(34, 197, 94, 0.1); border-radius: 8px; margin-top: 12px; }
        
        .meta-block { margin-top: auto; padding-top: 16px; border-top: 1px solid rgba(55, 65, 81, 0.8); font-size: 11px; color: #9ca3af; display: flex; flex-direction: column; gap: 4px; }
        .meta-title { font-size: 11px; letter-spacing: 0.16em; text-transform: uppercase; color: #a5b4fc; text-shadow: 0 0 8px rgba(129, 140, 248, 0.6); }
        .meta-links { display: flex; justify-content: space-between; gap: 8px; flex-wrap: wrap; }
        .meta-link { color: #38bdf8; text-decoration: none; font-size: 11px; cursor: pointer; }
        .meta-link:hover { text-decoration: underline; }
        
        @media (max-width: 480px) { 
            .card { padding: 14px 10px 12px; } 
            .title { font-size: 16px; } 
            textarea { min-height: 80px; } 
            .converter-row { flex-direction: column; }
            .currency-converter-row { flex-direction: column; }
        }
        @keyframes pulseGlow { 0%, 100% { box-shadow: 0 0 0 rgba(56, 189, 248, 0); } 50% { box-shadow: 0 0 18px rgba(56, 189, 248, 0.9); } }
        @keyframes titleGlow { 0%, 100% { text-shadow: 0 0 4px rgba(56, 189, 248, 0.5), 0 0 8px rgba(59, 130, 246, 0.4); } 50% { text-shadow: 0 0 10px rgba(56, 189, 248, 1), 0 0 22px rgba(59, 130, 246, 0.9); } }
        @keyframes bgShift { 0% { background: radial-gradient(circle at top, #0ea5e9 0, #020617 50%, #000000 100%); } 50% { background: radial-gradient(circle at top, #6366f1 0, #020617 55%, #000000 100%); } 100% { background: radial-gradient(circle at top, #ec4899 0, #020617 50%, #000000 100%); } }
        @keyframes sphereFloat { 0% { transform: translateY(0px) rotate(0deg); opacity: 0.7; } 50% { transform: translateY(-8px) rotate(180deg); opacity: 1; } 100% { transform: translateY(0px) rotate(360deg); opacity: 0.7; } }
    </style>
</head>
<body>
    <div class="card">
        <div class="lang-selector">
            <select class="lang-dropdown" id="langSelect" onchange="changeLanguage(this.value)">
                <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                <option value="en">üá¨üáß English</option>
                <option value="tt">üáπüáπ –¢–∞—Ç–∞—Ä—Å–∫–∏–π</option>
            </select>
        </div>
 
        <div class="card-header">
            <div class="avatar">NC</div>
            <div class="title-block">
                <div class="title">NEUROCORE</div>
                <div class="subtitle" id="subtitle">–£—á—ë–±–∞ ¬∑ —Ç–µ–∫—Å—Ç—ã ¬∑ –∏–¥–µ–∏ ¬∑ 18+</div>
            </div>
            <div class="badge">beta</div>
        </div>
 
        <div class="buttons-grid">
            <button class="btn primary" onclick="setMode('question')">
                <span class="label" id="btn1-label">–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å</span>
                <span class="desc" id="btn1-desc">–°–ø—Ä–æ—Å–∏ —á—Ç–æ —É–≥–æ–¥–Ω–æ</span>
            </button>
            <button class="btn secondary" onclick="setMode('explain')">
                <span class="label" id="btn2-label">–û–±—ä—è—Å–Ω–∏—Ç—å —Ç–µ–º—É</span>
                <span class="desc" id="btn2-desc">–¢–µ–º—ã, –∑–∞–¥–∞—á–∏, —Ç–µ–æ—Ä–∏—é</span>
            </button>
            <button class="btn secondary" onclick="setMode('fix')">
                <span class="label" id="btn3-label">–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç</span>
                <span class="desc" id="btn3-desc">–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è –∏ —Å—Ç–∏–ª—å</span>
            </button>
            <button class="btn secondary" onclick="setMode('ideas')">
                <span class="label" id="btn4-label">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏</span>
                <span class="desc" id="btn4-desc">–ü—Ä–æ–µ–∫—Ç—ã, —Å—é–∂–µ—Ç—ã, –ø–æ–¥–∞—Ä–∫–∏</span>
            </button>
        </div>
 
        <textarea id="prompt" placeholder="–ù–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç –¥–ª—è NeuroCore‚Ä¶"></textarea>
        <div class="bottom-row">
            <div class="hint" id="hint">–≠—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ Mini App. –¢–µ–∫—Å—Ç —É–ª–µ—Ç–∏—Ç –±–æ—Ç—É —á–µ—Ä–µ–∑ WebApp.</div>
            <button class="send-btn" id="sendBtn" onclick="sendToBot()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
 
        <div class="add-group">
            <button class="add-group-btn" type="button" id="addGroupBtn" onclick="inviteToGroup()">
                üë• <span id="addBtnText">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å NeuroCore –≤ –≥—Ä—É–ø–ø—É</span>
            </button>
        </div>
 
        <div class="section-divider"></div>
        <div class="section-title">
            <div class="section-icon games-icon">
                <div class="game-sphere sphere-1"></div>
                <div class="game-sphere sphere-2"></div>
                <div class="game-sphere sphere-3"></div>
            </div>
            <span id="gamesTitle">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</span>
        </div>
        <div style="text-align: center; color: #6b7280; font-size: 14px;">
            <span id="comingSoon" class="coming-soon">–°–∫–æ—Ä–æ...</span>
        </div>
 
        <div class="section-divider"></div>
        <!-- ‚úÖ –ö–†–ò–ü–¢–û –ë–õ–û–ö -->
        <div class="section-title">
            <div class="section-icon crypto-icon">
                <div class="crypto-arrow"></div>
                <div class="crypto-arrow"></div>
                <div class="crypto-arrow"></div>
            </div>
            <span id="cryptoTitle">–ö—Ä–∏–ø—Ç–∞</span>
        </div>
        <div class="crypto-section">
            <div class="crypto-title">
                <span class="crypto-price" id="cryptoPrice">145,99 ‚ÇΩ</span>
                <span id="cryptoChange" style="font-size: 12px; color: #10b981;">‚û°2.2%</span>
            </div>
            <div class="crypto-coins">
                <button class="coin-btn ton active" onclick="setCryptoCoin(event, 'ton')">TON</button>
                <button class="coin-btn btc" onclick="setCryptoCoin(event, 'btc')">BTC</button>
                <button class="coin-btn not" onclick="setCryptoCoin(event, 'not')">NOT</button>
            </div>
            <div class="chart-container">
                <canvas id="cryptoChart"></canvas>
            </div>
            <div class="timeframes">
                <button class="timeframe-btn" data-time="1h" onclick="setTimeframe(event, '1h')">1—á</button>
                <button class="timeframe-btn" data-time="6h" onclick="setTimeframe(event, '6h')">6—á</button>
                <button class="timeframe-btn active" data-time="1d" onclick="setTimeframe(event, '1d')">1–¥</button>
                <button class="timeframe-btn" data-time="7d" onclick="setTimeframe(event, '7d')">7–¥</button>
            </div>
        </div>

        <!-- ‚úÖ –ö–û–ù–í–ï–†–¢–ï–† –ö–†–ò–ü–¢–ê ‚Üí –†–£–ë–õ–ò -->
        <div class="section-title">
            <div class="section-icon converter-icon">
                <div class="rub-sign">‚ÇΩ</div>
                <div class="rub-sign">‚ÇΩ</div>
            </div>
            <span>–ö—Ä–∏–ø—Ç–∞ ‚Üí ‚ÇΩ</span>
        </div>
        <div class="crypto-converter">
            <div class="converter-row">
                <input type="number" class="converter-input" id="cryptoAmount" placeholder="1.5" step="any" min="0" value="1" oninput="convertCryptoToRub()">
                <select class="converter-select" id="cryptoCoinSelect" onchange="convertCryptoToRub()">
                    <option value="ton">TON</option>
                    <option value="btc">BTC</option>
                    <option value="not">NOT</option>
                </select>
            </div>
            <div class="converter-result" id="cryptoRubResult">145,99 ‚ÇΩ</div>
        </div>

        <div class="section-divider"></div>
        <!-- ‚úÖ –ë–õ–û–ö –í–ê–õ–Æ–¢ -->
        <div class="section-title">
            <div class="section-icon currency-icon">
                <div class="currency-dollar">$</div>
                <div class="currency-dollar">‚Ç¨</div>
            </div>
            <span>–í–∞–ª—é—Ç—ã</span>
        </div>
        <div class="currency-section">
            <div class="currency-converter-row">
                <input type="number" class="converter-input" id="currencyAmount" placeholder="1" step="any" min="0" value="1" oninput="convertCurrency()">
                <select class="converter-select" id="currencySelect" onchange="convertCurrency()">
                    <option value="usd">USD</option>
                    <option value="eur">EUR</option>
                    <option value="byn">BYN</option>
                    <option value="kzt">KZT</option>
                </select>
            </div>
            <div class="currency-chart-container">
                <canvas id="currencyChart"></canvas>
            </div>
            <div class="currency-result" id="currencyRubResult">80,44 ‚ÇΩ</div>
        </div>
 
        <div class="meta-block">
            <div class="meta-title">SYSTEM</div>
            <div class="meta-links">
                <a class="meta-link" href="https://oppennnbox.github.io/neurocore-miniapp/privacy.html" target="_blank" id="privacyLink">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                <a class="meta-link" href="https://t.me/genuis_neo_bot" target="_blank" id="devLink">–°–≤—è–∑—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º</a>
            </div>
        </div>
    </div>
 
    <script>
        // –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentMode = 'question';
        let currentLang = 'ru';
        let currentCoin = 'ton';
        let currentTimeframe = '1d';
        let cryptoChart = null;
        let currencyChart = null;
        let usdToRubRate = 80.44;
        const tg = window.Telegram?.WebApp || {};
        
        // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–ª—è fallback (–Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞)
        const fallbackCryptoPrices = {
            ton: 145.99,
            btc: 5246888,    // ~65200 USD * 80.44 RUB
            not: 0.68374     // ~0.0085 USD * 80.44 RUB
        };
        
        const fallbackChanges = {
            ton: 2.2,
            btc: 1.9,
            not: 7.5
        };

        // CoinGecko IDs
        const COINGECKO_IDS = {
            ton: 'the-open-network',
            btc: 'bitcoin', 
            not: 'notcoin'
        };

        // –¶–≤–µ—Ç–∞
        const coinColors = {
            ton: '#8b5cf6',
            btc: '#f59e0b', 
            not: '#06b6d4'
        };
        const currencyColors = {
            usd: '#10b981',
            eur: '#3b82f6',
            byn: '#f59e0b',
            kzt: '#ef4444'
        };

        const translations = {
            ru: {
                subtitle: "–£—á—ë–±–∞ ¬∑ —Ç–µ–∫—Å—Ç—ã ¬∑ –∏–¥–µ–∏ ¬∑ 18+",
                btn1_label: "–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å", btn1_desc: "–°–ø—Ä–æ—Å–∏ —á—Ç–æ —É–≥–æ–¥–Ω–æ",
                btn2_label: "–û–±—ä—è—Å–Ω–∏—Ç—å —Ç–µ–º—É", btn2_desc: "–¢–µ–º—ã, –∑–∞–¥–∞—á–∏, —Ç–µ–æ—Ä–∏—é",
                btn3_label: "–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç", btn3_desc: "–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è –∏ —Å—Ç–∏–ª—å",
                btn4_label: "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏", btn4_desc: "–ü—Ä–æ–µ–∫—Ç—ã, —Å—é–∂–µ—Ç—ã, –ø–æ–¥–∞—Ä–∫–∏",
                placeholder: "–ù–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç –¥–ª—è NeuroCore‚Ä¶",
                hint: "–≠—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ Mini App. –¢–µ–∫—Å—Ç —É–ª–µ—Ç–∏—Ç –±–æ—Ç—É —á–µ—Ä–µ–∑ WebApp.",
                send: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
                addBtnText: "–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å NeuroCore –≤ –≥—Ä—É–ø–ø—É",
                gamesTitle: "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
                comingSoon: "–°–∫–æ—Ä–æ...",
                cryptoTitle: "–ö—Ä–∏–ø—Ç–∞",
                privacy: "–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏",
                dev: "–°–≤—è–∑—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º"
            },
            en: {
                subtitle: "Study ¬∑ texts ¬∑ ideas ¬∑ 18+",
                btn1_label: "Ask a question", btn1_desc: "Ask anything",
                btn2_label: "Explain topic", btn2_desc: "Subjects, problems, theory",
                btn3_label: "Fix text", btn3_desc: "Spelling & style",
                btn4_label: "Generate ideas", btn4_desc: "Projects, plots, gifts",
                placeholder: "Write something for NeuroCore‚Ä¶",
                hint: "This interface works as a Mini App. The text will be sent to the bot via WebApp.",
                send: "Send",
                addBtnText: "Invite NeuroCore to group",
                gamesTitle: "Games",
                comingSoon: "Coming soon...",
                cryptoTitle: "Crypto",
                privacy: "Privacy Policy",
                dev: "Contact developer"
            },
            tt: {
                subtitle: "–£–∫—É ¬∑ —Ç–µ–∫—Å—Ç–ª–∞—Ä ¬∑ –∏–¥–µ—è–ª–∞—Ä ¬∑ 18+",
                btn1_label: "–°–æ—Ä–∞—É –±–∏—Ä–µ—Ä–≥”ô", btn1_desc: "–¢–µ–ª”ô—Å”ô–Ω–≥”ô —Å–æ—Ä–∞",
                btn2_label: "–¢–µ–º–∞ —Ñ”ô–Ω–Ω–∏", btn2_desc: "–¢–µ–º–∞–ª–∞—Ä, –º”ô—Å—å”ô–ª”ô–ª”ô—Ä, —Ç–µ–æ—Ä–∏—è",
                btn3_label: "–¢–µ–∫—Å—Ç–Ω—ã —Ç”©–∑”ô—Ç", btn3_desc: "–Ø–∑–º–∞–ª–∞—Ä “ª”ô–º —Å—Ç–∏–ª—å",
                btn4_label: "–ò–¥–µ—è–ª–∞—Ä —è—Å”ô", btn4_desc: "–ü—Ä–æ–µ–∫—Ç–ª–∞—Ä, —Å—é–∂–µ—Ç–ª–∞—Ä, —Ç–∞—Ä—Ç—É–ª–∞—Ä",
                placeholder: "NeuroCore ”©—á–µ–Ω —Ç–µ–∫—Å—Ç —è–∑‚Ä¶",
                hint: "–ë—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Mini App —Å—ã–Ω—ã—Ñ—ã–Ω–¥–∞ —ç—à–ª–∏. –¢–µ–∫—Å—Ç –±–æ—Ç–∫–∞ WebApp –∞—à–∞ –æ—á—ã–ø –±–∞—Ä—ã—Ä–≥–∞ —Ç–∏–µ—à.",
                send: "“ñ–∏–±”ô—Ä“Ø",
                addBtnText: "NeuroCore-–Ω—ã –≥—Ä—É–ø–ø–∫–∞ —á–∞–∫—ã—Ä—ã—Ä–≥–∞",
                gamesTitle: "–í–∞–∫—ã—Ç “Ø—Ç–∫”ô—Ä“Ø",
                comingSoon: "–¢–∏–∑–¥”ô–Ω...",
                cryptoTitle: "–ö—Ä–∏–ø—Ç–∞",
                privacy: "–§”ô—Ä–µ—à—Ç”ô–ª–µ–∫ —Å–∏–∏—Å–∞—Ç–µ",
                dev: "–î–µ–≤–µ–ª–æ–ø–µ—Ä –±–µ–ª”ô–Ω –±”ô–π–ª”ô–Ω–µ—à"
            }
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
        if (tg.initDataUnsafe) tg.expand();
        if (tg.MainButton) {
            tg.MainButton.setText('–û—Ç–ø—Ä–∞–≤–∏—Ç—å').show().onClick(sendToBot);
        }

        // ‚úÖ –§–£–ù–ö–¶–ò–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –†–ï–ê–õ–¨–ù–û–ì–û –ö–£–†–°–ê –ö–†–ò–ü–¢–û–í–ê–õ–Æ–¢ –í RUB
        async function fetchCryptoToRub(coin) {
            try {
                const coinId = COINGECKO_IDS[coin];
                // –ü–æ–ª—É—á–∞–µ–º –∫—É—Ä—Å –Ω–∞–ø—Ä—è–º—É—é –≤ RUB
                const response = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${coinId}&vs_currencies=rub&include_24hr_change=true`);
                
                if (!response.ok) {
                    throw new Error('CoinGecko API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç');
                }
                
                const data = await response.json();
                
                if (data[coinId] && data[coinId].rub) {
                    return {
                        price: data[coinId].rub,
                        change: data[coinId].rub_24h_change || 0
                    };
                }
                
                // –ï—Å–ª–∏ –ø—Ä—è–º–æ–≥–æ –∫—É—Ä—Å–∞ –Ω–µ—Ç, –ø–æ–ª—É—á–∞–µ–º —á–µ—Ä–µ–∑ USD
                const usdResponse = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${coinId}&vs_currencies=usd&include_24hr_change=true`);
                const usdData = await usdResponse.json();
                const usdRate = await fetchUsdToRub();
                
                if (usdData[coinId] && usdData[coinId].usd) {
                    return {
                        price: usdData[coinId].usd * usdRate,
                        change: usdData[coinId].usd_24h_change || 0
                    };
                }
                
                throw new Error('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–∞ –∫—Ä–∏–ø—Ç—ã:', error);
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
                return {
                    price: fallbackCryptoPrices[coin] || 1,
                    change: fallbackChanges[coin] || 0
                };
            }
        }

        // ‚úÖ –§–£–ù–ö–¶–ò–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –†–ï–ê–õ–¨–ù–û–ì–û –ö–£–†–°–ê USD‚ÜíRUB
        async function fetchUsdToRub() {
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º API –¶–µ–Ω—Ç—Ä–æ–±–∞–Ω–∫–∞ –†–æ—Å—Å–∏–∏
                const response = await fetch('https://www.cbr-xml-daily.ru/daily_json.js');
                if (!response.ok) throw new Error('CBR API failed');
                
                const data = await response.json();
                usdToRubRate = data.Valute.USD.Value;
                console.log('–¢–µ–∫—É—â–∏–π –∫—É—Ä—Å USD/RUB:', usdToRubRate);
                return usdToRubRate;
            } catch (error) {
                console.log('API –¶–ë –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—é —Ä–µ–∑–µ—Ä–≤–Ω—ã–π API:', error);
                
                try {
                    // –†–µ–∑–µ—Ä–≤–Ω—ã–π API - exchangerate.host
                    const response = await fetch('https://api.exchangerate.host/latest?base=USD&symbols=RUB');
                    if (!response.ok) throw new Error('ExchangeRate API failed');
                    
                    const data = await response.json();
                    usdToRubRate = data.rates.RUB;
                    console.log('–†–µ–∑–µ—Ä–≤–Ω—ã–π –∫—É—Ä—Å USD/RUB:', usdToRubRate);
                    return usdToRubRate;
                } catch (error2) {
                    console.log('–í—Å–µ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É—é fallback');
                    usdToRubRate = 80.44;
                    return usdToRubRate;
                }
            }
        }

        // ‚úÖ –§–£–ù–ö–¶–ò–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –†–ï–ê–õ–¨–ù–´–• –ö–£–†–°–û–í –í–ê–õ–Æ–¢
        async function fetchCurrencyRates() {
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º API –¶–µ–Ω—Ç—Ä–æ–±–∞–Ω–∫–∞ –†–æ—Å—Å–∏–∏
                const response = await fetch('https://www.cbr-xml-daily.ru/daily_json.js');
                if (!response.ok) throw new Error('CBR API failed');
                
                const data = await response.json();
                
                const rates = {
                    usd: data.Valute.USD?.Value || 80.44,
                    eur: data.Valute.EUR?.Value || 88.00,
                    byn: data.Valute.BYN?.Value || 25.00,
                    kzt: (data.Valute.KZT?.Value || 0.18) / 100 // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ 1 —Ç–µ–Ω–≥–µ
                };
                
                console.log('–ö—É—Ä—Å—ã –≤–∞–ª—é—Ç:', rates);
                return rates;
            } catch (error) {
                console.log('API –¶–ë –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–æ–±—É—é –¥—Ä—É–≥–æ–π API:', error);
                
                try {
                    // –ü—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π API
                    const response = await fetch('https://api.exchangerate.host/latest?base=RUB&symbols=USD,EUR,BYN,KZT');
                    if (!response.ok) throw new Error('ExchangeRate API failed');
                    
                    const data = await response.json();
                    
                    const rates = {
                        usd: 1 / (data.rates.USD || 0.0125),
                        eur: 1 / (data.rates.EUR || 0.0114),
                        byn: 1 / (data.rates.BYN || 0.04),
                        kzt: 1 / (data.rates.KZT || 5.56)
                    };
                    
                    console.log('–ö—É—Ä—Å—ã –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ API:', rates);
                    return rates;
                } catch (error2) {
                    console.log('–í—Å–µ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É—é fallback');
                    return {
                        usd: 80.44,
                        eur: 88.00,
                        byn: 25.00,
                        kzt: 0.18
                    };
                }
            }
        }

        // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–ù–í–ï–†–¢–ï–† –ö–†–ò–ü–¢–ê ‚Üí –†–£–ë–õ–ò
        async function convertCryptoToRub() {
            const amount = parseFloat(document.getElementById('cryptoAmount').value) || 0;
            const coin = document.getElementById('cryptoCoinSelect').value;
            
            if (amount <= 0) {
                document.getElementById('cryptoRubResult').textContent = '0 ‚ÇΩ';
                return;
            }

            try {
                // –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –∫—É—Ä—Å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –≤ —Ä—É–±–ª—è—Ö
                const cryptoData = await fetchCryptoToRub(coin);
                const result = amount * cryptoData.price;
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                let formattedResult;
                if (result >= 1000000) {
                    formattedResult = (result / 1000000).toFixed(2) + ' –º–ª–Ω ‚ÇΩ';
                } else if (result >= 1000) {
                    formattedResult = (result / 1000).toFixed(1) + ' —Ç—ã—Å ‚ÇΩ';
                } else {
                    formattedResult = result.toLocaleString('ru-RU', { 
                        minimumFractionDigits: 0, 
                        maximumFractionDigits: 2 
                    }) + ' ‚ÇΩ';
                }
                
                document.getElementById('cryptoRubResult').textContent = formattedResult;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∫—Ä–∏–ø—Ç—ã:', error);
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º fallback –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
                const result = amount * (fallbackCryptoPrices[coin] || 1);
                document.getElementById('cryptoRubResult').textContent = 
                    result.toLocaleString('ru-RU', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) + ' ‚ÇΩ';
            }
        }

        // ‚úÖ –ö–û–ù–í–ï–†–¢–ï–† –í–ê–õ–Æ–¢–ê ‚Üí –†–£–ë–õ–ò
        async function convertCurrency() {
            const amount = parseFloat(document.getElementById('currencyAmount').value) || 0;
            const currency = document.getElementById('currencySelect').value;
            
            if (amount <= 0) {
                document.getElementById('currencyRubResult').textContent = '0 ‚ÇΩ';
                return;
            }

            try {
                // –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç
                const rates = await fetchCurrencyRates();
                const rate = rates[currency];
                
                if (!rate) {
                    throw new Error('–ù–µ—Ç –∫—É—Ä—Å–∞ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∞–ª—é—Ç—ã');
                }
                
                const result = amount * rate;
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                let formattedResult;
                if (result >= 1000000) {
                    formattedResult = (result / 1000000).toFixed(2) + ' –º–ª–Ω ‚ÇΩ';
                } else if (result >= 1000) {
                    formattedResult = (result / 1000).toFixed(1) + ' —Ç—ã—Å ‚ÇΩ';
                } else {
                    formattedResult = result.toLocaleString('ru-RU', { 
                        minimumFractionDigits: 0, 
                        maximumFractionDigits: 2 
                    }) + ' ‚ÇΩ';
                }
                
                document.getElementById('currencyRubResult').textContent = formattedResult;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫
                updateCurrencyChart(currency, rate);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤–∞–ª—é—Ç—ã:', error);
                // Fallback –∫—É—Ä—Å—ã
                const fallbackRates = {
                    usd: 80.44,
                    eur: 88.00,
                    byn: 25.00,
                    kzt: 0.18
                };
                const result = amount * (fallbackRates[currency] || 1);
                document.getElementById('currencyRubResult').textContent = 
                    result.toLocaleString('ru-RU', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) + ' ‚ÇΩ';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º fallback –≥—Ä–∞—Ñ–∏–∫
                updateFallbackCurrencyChart(currency);
            }
        }

        // ‚úÖ –ì–†–ê–§–ò–ö –í–ê–õ–Æ–¢
        async function updateCurrencyChart(currency, currentRate) {
            const canvas = document.getElementById('currencyChart');
            const ctx = canvas.getContext('2d');
            
            if (currencyChart) {
                currencyChart.destroy();
                currencyChart = null;
            }

            try {
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                const baseRate = currentRate || 80.44;
                const labels = ['6 –¥–Ω.', '5 –¥–Ω.', '4 –¥–Ω.', '3 –¥–Ω.', '2 –¥–Ω.', '–í—á–µ—Ä–∞', '–°–µ–≥–æ–¥–Ω—è'];
                
                const values = [];
                for (let i = 6; i >= 0; i--) {
                    const variation = baseRate * (0.98 + Math.random() * 0.04);
                    const trend = (i / 10) * (Math.random() > 0.5 ? 0.01 : -0.01);
                    values.push(variation * (1 + trend));
                }
                values[6] = baseRate;

                currencyChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: `${currency.toUpperCase()} ‚Üí RUB`,
                            data: values,
                            borderColor: currencyColors[currency],
                            backgroundColor: currencyColors[currency] + '20',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 3,
                            pointBackgroundColor: currencyColors[currency],
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.raw.toFixed(2)} ‚ÇΩ`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                grid: { display: false },
                                ticks: { 
                                    color: '#94a3b8', 
                                    font: { size: 10 },
                                    maxRotation: 0
                                }
                            },
                            y: {
                                beginAtZero: false,
                                grid: { color: 'rgba(148, 163, 184, 0.15)' },
                                ticks: { 
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value.toFixed(1) + ' ‚ÇΩ';
                                    }
                                }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        animation: {
                            duration: 1000,
                            easing: 'easeOutQuart'
                        }
                    }
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞ –≤–∞–ª—é—Ç—ã:', error);
                updateFallbackCurrencyChart(currency);
            }
        }

        // ‚úÖ FALLBACK –ì–†–ê–§–ò–ö –î–õ–Ø –í–ê–õ–Æ–¢
        function updateFallbackCurrencyChart(currency) {
            const canvas = document.getElementById('currencyChart');
            const ctx = canvas.getContext('2d');
            
            if (currencyChart) {
                currencyChart.destroy();
                currencyChart = null;
            }
            
            const baseRates = {
                usd: 80.44,
                eur: 88.00,
                byn: 25.00,
                kzt: 0.18
            };
            
            const baseRate = baseRates[currency] || 1;
            const data = [];
            const labels = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
            
            for (let i = 0; i < 7; i++) {
                const variation = baseRate * (0.98 + Math.sin(i * 0.5) * 0.02 + (Math.random() - 0.5) * 0.02);
                data.push(variation);
            }
            data[6] = baseRate;
            
            currencyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        borderColor: currencyColors[currency],
                        backgroundColor: currencyColors[currency] + '20',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: { color: '#94a3b8', font: { size: 10 } }
                        },
                        y: {
                            grid: { color: 'rgba(148, 163, 184, 0.15)' },
                            ticks: {
                                color: '#94a3b8',
                                callback: function(value) {
                                    return value.toFixed(1) + ' ‚ÇΩ';
                                }
                            }
                        }
                    }
                }
            });
        }

        // ‚úÖ –û–ë–ù–û–í–õ–ï–ù–ò–ï –¶–ï–ù–´ –ö–†–ò–ü–¢–û–í–ê–õ–Æ–¢
        async function updateCryptoPrice() {
            try {
                const cryptoData = await fetchCryptoToRub(currentCoin);
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ü–µ–Ω—É –≤ —Ä—É–±–ª—è—Ö –∫–∞–∫ –≤ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ
                document.getElementById('cryptoPrice').textContent = cryptoData.price.toLocaleString('ru-RU', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                }) + ' ‚ÇΩ';
                
                const changeEl = document.getElementById('cryptoChange');
                const change = cryptoData.change || 0;
                changeEl.textContent = (change > 0 ? '‚û°' : '‚¨á') + Math.abs(change).toFixed(1) + '%';
                changeEl.style.color = change > 0 ? '#10b981' : '#ef4444';
                
                return cryptoData;
            } catch (error) {
                console.log('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã:', error);
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
                document.getElementById('cryptoPrice').textContent = fallbackCryptoPrices[currentCoin].toLocaleString('ru-RU', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                }) + ' ‚ÇΩ';
                
                const changeEl = document.getElementById('cryptoChange');
                const change = fallbackChanges[currentCoin] || 0;
                changeEl.textContent = (change > 0 ? '‚û°' : '‚¨á') + Math.abs(change) + '%';
                changeEl.style.color = change > 0 ? '#10b981' : '#ef4444';
                
                return {
                    price: fallbackCryptoPrices[currentCoin],
                    change: fallbackChanges[currentCoin]
                };
            }
        }

        // ‚úÖ –ì–†–ê–§–ò–ö –ö–†–ò–ü–¢–û–í–ê–õ–Æ–¢
        async function createRealChart() {
            const canvas = document.getElementById('cryptoChart');
            const ctx = canvas.getContext('2d');
            
            if (cryptoChart) {
                cryptoChart.destroy();
                cryptoChart = null;
            }

            try {
                const coinId = COINGECKO_IDS[currentCoin];
                let days = 1;
                if (currentTimeframe === '1h') days = 1;
                else if (currentTimeframe === '6h') days = 2;
                else if (currentTimeframe === '1d') days = 7;
                else days = 14;

                const response = await fetch(`https://api.coingecko.com/api/v3/coins/${coinId}/market_chart?vs_currency=usd&days=${days}&interval=daily`);
                const data = await response.json();
                
                const prices = data.prices.map(p => p[1]);
                const labels = prices.map((_, i) => '');

                cryptoChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: prices,
                            borderColor: coinColors[currentCoin],
                            backgroundColor: coinColors[currentCoin] + '20',
                            borderWidth: 2.5,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { grid: { display: false }, ticks: { display: false } },
                            y: {
                                grid: { color: 'rgba(148, 163, 184, 0.15)' },
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        if (value >= 1000) return '$' + (value / 1000).toFixed(1) + 'k';
                                        return '$' + value.toFixed(1);
                                    }
                                }
                            }
                        },
                        animation: { duration: 800 }
                    }
                });
            } catch (error) {
                createFallbackChart();
            }
        }

        // ‚úÖ FALLBACK –ì–†–ê–§–ò–ö –ö–†–ò–ü–¢–û–í–ê–õ–Æ–¢
        function createFallbackChart() {
            const canvas = document.getElementById('cryptoChart');
            const ctx = canvas.getContext('2d');
            
            if (cryptoChart) {
                cryptoChart.destroy();
                cryptoChart = null;
            }

            const basePrices = { 
                ton: 1.795, 
                btc: 95432.15, 
                not: 0.01234 
            };
            const data = [];
            const basePrice = basePrices[currentCoin] || 1;
            
            for (let i = 0; i < 24; i++) {
                const variation = basePrice * (0.94 + Math.sin(i * 0.3) * 0.08 + (Math.random() - 0.5) * 0.04);
                data.push(variation);
            }

            cryptoChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array(24).fill(''),
                    datasets: [{
                        data: data,
                        borderColor: coinColors[currentCoin],
                        backgroundColor: coinColors[currentCoin] + '20',
                        borderWidth: 2.5,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false }, ticks: { display: false } },
                        y: {
                            grid: { color: 'rgba(148, 163, 184, 0.15)' },
                            ticks: {
                                color: '#94a3b8',
                                callback: function(value) {
                                    if (value >= 1000) return '$' + (value / 1000).toFixed(1) + 'k';
                                    return '$' + value.toFixed(1);
                                }
                            }
                        }
                    },
                    animation: { duration: 800 }
                }
            });
        }

        // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –§–£–ù–ö–¶–ò–ò –° –ü–ï–†–ï–í–û–î–û–ú
        function changeLanguage(lang) {
            currentLang = lang;
            const t = translations[lang] || translations.ru;
            
            const elements = {
                'subtitle': 'subtitle',
                'btn1-label': 'btn1_label',
                'btn1-desc': 'btn1_desc',
                'btn2-label': 'btn2_label', 
                'btn2-desc': 'btn2_desc',
                'btn3-label': 'btn3_label',
                'btn3-desc': 'btn3_desc',
                'btn4-label': 'btn4_label',
                'btn4-desc': 'btn4_desc',
                'hint': 'hint',
                'addBtnText': 'addBtnText',
                'gamesTitle': 'gamesTitle',
                'comingSoon': 'comingSoon',
                'cryptoTitle': 'cryptoTitle',
                'privacyLink': 'privacy',
                'devLink': 'dev'
            };
            
            Object.keys(elements).forEach(id => {
                const el = document.getElementById(id);
                if (el) el.textContent = t[elements[id]] || el.textContent;
            });
            
            const prompt = document.getElementById('prompt');
            prompt.placeholder = (currentMode === 'question' ? '' : 
                (currentMode === 'explain' ? '–û–±—ä—è—Å–Ω–∏: ' : 
                (currentMode === 'fix' ? '–ò—Å–ø—Ä–∞–≤—å: ' : '–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∏–¥–µ–∏: '))) + t.placeholder;
            
            if (tg.MainButton) tg.MainButton.setText(t.send || '–û—Ç–ø—Ä–∞–≤–∏—Ç—å');
            localStorage.setItem('neurocore_lang', lang);
        }

        function setMode(mode) {
            currentMode = mode;
            const prompt = document.getElementById('prompt');
            const t = translations[currentLang] || translations.ru;
            const prefixes = { 
                question: '', 
                explain: '–û–±—ä—è—Å–Ω–∏: ', 
                fix: '–ò—Å–ø—Ä–∞–≤—å: ', 
                ideas: '–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∏–¥–µ–∏: ' 
            };
            prompt.placeholder = (prefixes[mode] || '') + t.placeholder;
            prompt.focus();
        }

        // ‚úÖ ‚úÖ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ö–ù–û–ü–ö–ò –î–û–ë–ê–í–õ–ï–ù–ò–Ø –í –ì–†–£–ü–ü–£
        function inviteToGroup() {
            const btn = document.getElementById('addGroupBtn');
            btn.style.transform = 'scale(0.97)';
            setTimeout(() => btn.style.transform = '', 150);
            
            // ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –°–°–´–õ–ö–ê –î–õ–Ø –í–´–ë–û–†–ê –ì–†–£–ü–ü–´
            const botUsername = 'genuis_neo_bot';
            const groupLink = `https://t.me/${botUsername}?startgroup=`;
            
            try {
                if (tg.openLink) {
                    tg.openLink(groupLink);
                } else if (tg.openTelegramLink) {
                    tg.openTelegramLink(groupLink);
                } else if (tg.openTelegramLink) {
                    tg.openTelegramLink(groupLink);
                } else {
                    window.open(groupLink, '_blank');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —Å—Å—ã–ª–∫–∏:', error);
                window.open(groupLink, '_blank');
            }
        }

        function sendToBot() {
            const text = document.getElementById('prompt').value.trim();
            if (!text) return;
            
            const t = translations[currentLang] || translations.ru;
            const modes = { 
                question: t.btn1_label || '–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å', 
                explain: t.btn2_label || '–û–±—ä—è—Å–Ω–∏—Ç—å —Ç–µ–º—É', 
                fix: t.btn3_label || '–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç', 
                ideas: t.btn4_label || '–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏' 
            };
            
            if (tg.sendData) {
                tg.sendData(JSON.stringify({ 
                    message: `${modes[currentMode]}: ${text}` 
                }));
            } else {
                console.log('–î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏:', { 
                    message: `${modes[currentMode]}: ${text}` 
                });
                alert('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–Ω—Å–æ–ª—å (—Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏)');
            }
            
            document.getElementById('prompt').value = '';
        }

        function setCryptoCoin(e, coin) {
            currentCoin = coin;
            document.querySelectorAll('.coin-btn').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            
            // ‚úÖ –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø –° –ö–û–ù–í–ï–†–¢–ï–†–û–ú
            document.getElementById('cryptoCoinSelect').value = coin;
            
            updateCryptoPrice().then(() => createRealChart());
            convertCryptoToRub();
        }

        function setTimeframe(e, timeframe) {
            currentTimeframe = timeframe;
            document.querySelectorAll('.timeframe-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.time === timeframe) btn.classList.add('active');
            });
            createRealChart();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            const savedLang = localStorage.getItem('neurocore_lang') || 'ru';
            document.getElementById('langSelect').value = savedLang;
            changeLanguage(savedLang);
            setMode('question');
            
            // ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–æ–Ω–µ—Ç
            document.getElementById('cryptoCoinSelect').value = currentCoin;
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–æ–≤
            setTimeout(() => {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫—Ä–∏–ø—Ç–æ –¥–∞–Ω–Ω—ã–µ
                updateCryptoPrice().then(() => createRealChart());
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã
                fetchUsdToRub().then(() => {
                    convertCryptoToRub();
                });
                
                convertCurrency();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
                setInterval(() => {
                    updateCryptoPrice().then(() => createRealChart());
                    fetchUsdToRub();
                    convertCryptoToRub();
                }, 120000);
                
            }, 500);
        });

        document.addEventListener('keydown', e => {
            if (e.ctrlKey && e.key === 'Enter') sendToBot();
        });
    </script>
</body>
</html>